## Pyramind of Pain : Consist of 6 layers

- It describes IOCs in relation to the level of difficulty and disruption a defender causes to an attacker when each type is denied. <br/>
- **Indicator of Compromise (IOCs)** : A piece which suggests that an endpoint/network may have been breached.<br/>

The pyramid consists of six layers, increasing in adversary “pain” as you go up: <br>
<img src="https://www.attackiq.com/wp-content/uploads/2019/06/blog-pyramid-pain-01.jpg" alt="Pyramid of Pain" width="350"/>

1. **Layer 1 - Hash Values** :
   - Unique alphanumeric value that is generated by a mathematical algorithm to a file.
   - MD5 = 128 bit / 32 characters (hexadecimal number)
   - SHA1 = 160 bit / 40 characters
   - SHA256 = 256 bit / 64 characters
   - They provide a unique reference to specific malwares/files.

2. **Layer 2 - IP Addresses** :
   - Numeric identities for internet locations.
   - Adversary can make IP blocking challenging by using Fast Flux
   - **Fast Flux** - DNS technique used by botnets to hide phishing, web proxying, malware delivery & malware communication activities behind compromised hosts acting as proxies.

3. **Layer 3 - Domain Names** :
   - Human readable identifiers for internet locations.
   - **Punycode Attack** - Attackers redirect users to a malicious domain which seems legit. A way of converting words that cannot be written in ASCII, into a unicode ASCII encoding.
   - Attackers usually hide malicious domains under URL Shortners.

4. **Layer 4 - Host/Network Artifacts** :
   - Traces left on system such as Registry values, suspicious process execution, attack patterns/IOCs, files dropped by malicious application.
   - Anything exclusive to current threat.

5. **Layer 5 - Tools** :
   - Specific tool attacker may use during an attack.
   - To prevent it we have AV Signatures, detection rules, YARA rules.
   - Fuzzy hashing performs similarity analysis - Match 2 files with minor difference based on fuzzy hash.
   - Another name for **FUZZY HASHING** - **CONTEXT TRIGGERED PIECEWISE HASHES**

6. **Layer 6 - TTPs** :
   - Includes whole MITRE ATT&CK Matrix.
   - If we can detect and respond to TTPs quickly, you leave attackers no chance.

The amount of pain you cause an adversary depends on the type of indicators you are able to make use of.

---

### Indicator Types and Defensive Strategy

| Indicator Type  | Strategic Impact | How to Validate with AEV (Adversarial Exposure Validation) |
|-----------------|-----------------|--------------------------|
| Hash values     | Minimal long-term value; attackers can recompile malware easily | Deploy known malicious files to validate AV & EDR capabilities |
| IP addresses    | Temporary disruption; attackers rotate servers | Simulate malicious IP activity to test firewall/IPS rules |
| Domain names    | Moderately disruptive; forces domain updates | Test DNS/web proxy filtering with malicious domains |
| Network artifacts | Requires attackers to modify C2 traffic | Emulate suspicious traffic and protocols |
| Host artifacts  | Raises costs; attackers must alter endpoint behaviors | Mimic malware-like actions to test EDR |
| Tools           | Forces adversaries to create or buy new tools | Use known attack tools for alert validation |
| TTPs            | Highest impact; attackers must change core behaviors | Run full attack chains (e.g., via MITRE ATT&CK) to test defenses |

> *Targeting behaviors TTPs, not just static IOCs, brings true resilience and forces attackers to meaningfully alter their approach to operations.*

---
